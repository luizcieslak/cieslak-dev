---
title: Entendendo o Safari - Limitações do navegador e como superá-las
excerpt: O Safari é o novo Internet Explorer e, por isso, requer um tratamento especial no desenvolvimento web.
publishDate: '2025-01-02'
seo:
  imagem:
    src: '/ie-apple.png'
    alt: Um meme que compara o Internet Explorer com o Safari usando os textos 'como começou' versus 'como está a correr'.
---

![Um meme que compara o Internet Explorer com o Safari utilizando os textos “como começou” e “como está a correr”](/ie-apple.png)

Não é nenhuma novidade quando dizemos que o Safari é o novo Internet Explorer. Esta constatação é feita porque o Safari tem uma [faixa importante do mercado de navegadores](https://gs.statcounter.com/browser-market-share) e tem uma experiência inferior à dos seus concorrentes, semelhante com o queaconteceu com o Internet Explorer na década de 2010.

Embora não considere que todos os navegadores devam ser um [fork do Chromium](https://support.microsoft.com/topic/microsoft-edge-chromium-1ce9507c-f09d-4de6-a706-eb52f46be90c) e que as _engines_ WebKit e Gecko contribuam para um ecossistema diverso, acredito que o tipo de navegadordeve ser, pelo menos, algo que devemos ter [liberdade de escolha](https://www-theverge-com.translate.goog/2024/1/25/24050478/apple-ios-17-4-browser-engines-eu).

É importante reconhecer o trabalho que os parceiros da [Igalia](https://mariospr.org/2024/11/03/igalia-and-webkit-status-update-and-plans-2024/) fazem para melhorar o WebKit e espero sinceramente que este artigo fique desatualizado em breve.

## Limitações

### Dispositivo

Não é possível solucionar problemas específicos do Safari se você não tiver um Macbook. Simples assim. Não há como instalar o Safari em uma máquina Windows ou Linux.

Tem de confiar em ferramentas de terceiros como o [BrowserStack] (https://www.browserstack.com/) para testar o seu site nesse browser.

### Múltiplas _streams_ de áudio

Se precisar de reproduzir mais do que uma faixa de áudio simultaneamente, por padrão não funciona no Safari. Para fazer isso, você precisaria controlar o atributo `muted` das duas _tags_ audio, iniciando-os com um valor `true` e, em seguida, alternando-o sempre que você quiser reproduzir ou pausar um deles. No exemplo abaixo funciona, mas somente com essa manipulação do _muted_.

<script async src=“//jsfiddle.net/luizcieslak/1wnptxjv/embed/”></script>

Vale a pena mencionar também esta outra solução de Matt Harrison que usa [Web Audio API](https://matt-harrison.com/posts/web-audio/).

### API de Informação da Conexão

_Nota: Também não funciona no Firefox._

Esta API acessível a partir de `navigator.connection` fornece informações úteis sobre a conexão de internet do usuário e pode ser utilizada para proporcionar uma experiência de personalizada ou otimizar as métricas de SEO. Por exemplo, se o usuário estiver conectado ao seu site em uma conexão lenta, você pode renderizar uma mesma imagem de qualidade inferior para não prejudicar a experiência.

https://caniuse.com/?search=navigator.connection

https://stackblitz.com/edit/sb1-grz58h1p?file=index.html

### API de URLPattern _matching_

_Nota: Também não funciona no Firefox._

Esta API tem a intenção de funcionar como o _Node Express Router_ faz como em:

```js
app.get('/users/:userId/books/:bookId', (req, res) => {
	res.send(req.params) // espera que userId e bookId estejam definidos
})
```

com o objetivo de identificar padrões específicos no URL. Isso pouparia muito código obscuro que precisa executar coisas como `url.split('/')[x]` para obter o valor de uma fatia específica do URL que você está procurando.

https://stackblitz.com/edit/sb1-8pwm2ekj?file=index.html

https://x.com/kennethrohde/status/1861860350850728137?t=wdKtlDRTUfpWAVLU9u7X1A

### Imagens sendo baixadas múltiplas vezes

_Nota: A maioria dos frameworks já lida com isso, como [Next.js](https://github.com/vercel/next.js/pull/22902) identificou em 2021._

Existe um bug no Safari na definição de tags de imagem usando a combinação de `srcset` e `sizes`, se o atributo sizes aparecer _depois_ do srcset. O Safari descarrega todas as imagens desconsiderando o atributo sizes.

https://stackblitz.com/edit/sb1-kbasvvhy

https://x.com/OliverJAsh/status/1812408504444989588?t=2nYDSmWCbSZmXsHxaD4ULw

### Filtros CSS

Qualquer elemento que utilize um [filtro CSS](https://developer.mozilla.org/en-US/docs/Web/CSS/filter) não será renderizado no Safari, a menos que você adicione um `translate3d(0, 0, 0.01)` junto com o filtro que deseja aplicar.

https://stackblitz.com/edit/sb1-avyznxai?file=index.html

https://x.com/Rich_Harris/status/1848771715603525834?t=I-c0JX506Y7p-rGRIeQqkw

### Posicionamento da âncora CSS

_Nota: Também não funciona no Firefox._

Esta funcionalidade CSS permite-nos posicionar declarativamente elementos relativamente a outros utilizando a função [anchor()](https://developer.mozilla.org/en-US/docs/Web/CSS/anchor).

https://caniuse.com/css-anchor-positioning

https://stackblitz.com/edit/sb1-1uaqivxx?file=src%2Fmain.tsx

### Estilos padrão do sistema operacional

Em todos os navegadores, o sistema operativo tem um estilos único para todos os elementos de UI. Para remover as diferenças variáveis entre eles, a recomendação é usar algum tipo de reset/normalizador de CSS como [modern-normalize](https://github.com/sindresorhus/modern-normalize) ou [normalize.css](https://github.com/necolas/normalize.css).

De qualquer forma, isto pode pegar desprevenido se o projeto em que está a trabalhar não os aplicar ou aplicar parcialmente.

<<adicionar imagem>>

No exemplo da captura de tela acima, você pode ver que a Apple define um preenchimento vertical padrão de `1em` para elementos de botão de envio de formulário, e abaixo o Chrome define um `0.5em` para eles.

<<adicionar imagem>>

### Problema em components _Slider_

Issues: https://github.com/tajo/react-range/issues/180, https://github.com/mui/material-ui/issues/31869

Em componentes Slider como o MUI acima, há um bug para o navegador móvel Safari do evento `onChange` onde ele dispara duas vezes. Precisamos literalmente verificar se é iOS e prevenir isso manualmente:

```js
const isIOS = () => {
	// função aqui que verifica o user agent para possíveis dispositivos iOS
}

const handleChange = (event, newValue) => {
	se (isIOS() && event.type === 'mousedown') {
		return
	}
	// Caso contrário, manipule execute o onChange normalmente
```

### Suporte a PWA

A Apple optou deliberadamente por atrasar as aplicações PWA há já algum tempo: https://open-web-advocacy.org/blog/its-official-apple-kills-web-apps-in-the-eu/
